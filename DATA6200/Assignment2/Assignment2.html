<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Justin Slater">

<title>DATA*6200 Assignment 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment2_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment2_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DATA*6200 Assignment 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Justin Slater </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="learning-objectives" class="level1">
<h1>Learning Objectives</h1>
<p>This assignment is meant to reinforce and assess the following skills:</p>
<ul>
<li>Intermediate data wrangling skills in R, including
<ul>
<li>Basic webscraping</li>
<li>Geospatial data wrangling</li>
</ul></li>
<li>Telling stories with data</li>
<li>Visualizing data over space and time</li>
<li>Critical thinking skills</li>
</ul>
</section>
<section id="your-task" class="level1">
<h1>Your task</h1>
<p>Wildfires are a growing concern in Canada, particularly in British Columbia (B.C). Resultingly, the B.C government has records of all substantial fires <a href="https://www2.gov.bc.ca/gov/content/safety/wildfire-status/about-bcws/wildfire-statistics">historically (2012-2017)</a>, and <a href="https://www2.gov.bc.ca/gov/content/safety/wildfire-status/about-bcws/disclaimer">currently</a>.</p>
<p>In this assignment, I want you to analyze the wildfire distribution in B.C over time from 2012-2017, and compare this to the current data. I also want you to determine what climate and environmental factors increase impact fire likelihood.</p>
<p>To do this, take the following steps:</p>
<ol type="1">
<li>Scrape the 2012-2017 data using methods we used in class.</li>
<li>Pull temperature and elevation data for B.C using the <code>geodata</code> package. Crop and mask as needed.</li>
<li>Visualize wildfires over time between 2012-2017 overtop a temperature raster.</li>
<li>Use a maximum of two visualizations to answer the question: how do temperature/elevation impact fire occurence?</li>
<li>How does the historical distribution (2012-2017) of wildfires differ from this year’s (2024) wildfires?</li>
</ol>
<p>Your visualizations should be standalone, but complete answers to the questions will also involve written descriptions. These written descriptions should include a discussion of data/analysis limitations.</p>
</section>
<section id="submission" class="level1">
<h1>Submission</h1>
<p>You should submit a .rmd/.qmd file (not a presentation) that contains all code used to wrangle the data and produce visualizations. You should knit/compile to an html file, which should contain visualizations, key code chunks, and brief written descriptions of your answers.</p>
<p>You can organize your document into sections corresponding to the question numbers, or in any other reasonable way.</p>
<section id="tips" class="level2">
<h2 class="anchored" data-anchor-id="tips">Tips</h2>
<ul>
<li>Be concise and specific. Concise code and descriptions are your best friend. Please do not submit ChatGPT “valuable insights” paragraphs that could apply to any analysis. When discussing data limitations, try to offer specific limitations about <strong>these data</strong>, not limitations that could be said about any data. E.g rather than say “there are missing values”, you may discuss <strong>how</strong> missingness impacts your ability to answer one of the questions, and what the impact may be.</li>
<li>Use methods shown in class wherever possible.</li>
<li>Take pride in your final report’s format.</li>
<li>Use descriptive figure captions for complex visualizations.</li>
</ul>
</section>
</section>
<section id="grading-scheme-45-marks-total" class="level1">
<h1>Grading Scheme [45 marks total]</h1>
<p>The following rubric depicts the grade breakdown for this assignment, followed by statements that are consistent with certain grade levels. Please note that a more detailed rubric will be used for grading. However, we do not provide you with a more detailed rubric at this stage, because this would give too many clues on how the assignment should be done. Also note that although these statements are guidelines for what a strong assignment submission looks like, the final grade is ultimately made at the discretion of the instructor/TA.</p>
<section id="code-quality-10-points" class="level3">
<h3 class="anchored" data-anchor-id="code-quality-10-points">Code quality [10 points]</h3>
<p><em>Note: It is your job to know what good coding practices are based on the lectures/readings.</em></p>
<ul>
<li>[9-10] Code is clear and concise, and lacks unnecessary repetition. Code clearly demonstrates the techniques learned in class, and follows good programming practices. The code is well documented and easy to follow.</li>
<li>[7-8] Code is mostly clear and concise, but tends to over-rely on one or two techniques. The code is mostly well documented, but some comments are missing. “Over-commenting” may be present.</li>
<li>[5-6] Code “gets the job done” but is very hard to follow or includes unnecessary chunks. Methods from outside the class are implemented with no explanation or description.</li>
<li>[&lt;5] inadequate</li>
</ul>
</section>
<section id="data-processing-decisions-10-marks" class="level3">
<h3 class="anchored" data-anchor-id="data-processing-decisions-10-marks">Data Processing Decisions [10 marks]</h3>
<ul>
<li>[9-10] Data cleaning and processing decisions are well-justified in context of research question(s). The student made extra effort to get the most out of the data at hand. Data is formatted according to principles discussed in class.</li>
<li>[7-8] Most data cleaning/processing decisions are justified, with some processing decisions potentially being misguided. Data is formatted according to principles discussed in class, with 1 or 2 noticeable inaccuracies.</li>
<li>[5-6] Data cleaning/processing decisions are not well justified. Many observations are binned or discarded without much thought. Data is not well formatted after processing.</li>
<li>[&lt;5] Inadequate</li>
</ul>
</section>
<section id="data-visualizations-and-descriptions-20-marks" class="level2">
<h2 class="anchored" data-anchor-id="data-visualizations-and-descriptions-20-marks">Data visualizations and descriptions [20 marks]</h2>
<ul>
<li>[18-20] Visualizations are attractive, well captioned and mostly convey their point on their own. Good graphing principles are followed in all visualizations, applying advanced ggplot features when necessary. Arguments and descriptions accompanying each figure are clear and concise, are specific to the problem at hand, and help convey the student’s point. Figure captions are well utilized. Limitation of the data/analysis are clearly described in the context of the questions.</li>
<li>[14-17] Visualizations are mostly attractive, with minor unclear elements. Good graphing principles are mostly followed in some visualizations, but not in others. Arguments and descriptions accompanying the figures are mostly clear and concise, but may be more vague than necessary. Figure Captions are utilized, but may not tell the whole story. Limitation of the data/analysis are described mostly in the context of the questions.</li>
<li>[10-13] Visualizations lack clarity in key areas, and are hard to interpret without additional explanation. Arguments and descriptions accompanying the visualizations are vague or are irrelevant to answering the research questions(s). Captions are not used or are misapplied. Limitation of the data/analysis are vague and not specific to the questions posed.</li>
<li>[&lt;10] Inadequate</li>
</ul>
</section>
<section id="formatting-and-reproducibility-5-marks" class="level2">
<h2 class="anchored" data-anchor-id="formatting-and-reproducibility-5-marks">Formatting and Reproducibility [5 marks]</h2>
<ul>
<li>[5] The analysis was reproducible with minimal effort. Results from the reproduced file match those from the submitted file. The document is easy to follow and is professionally presented.</li>
<li>[3-4] The analysis required substantial effort to reproduce. There are minor discrepancies between the submitted file and reproduced file. The document is mostly well-presented.</li>
<li>[0-2] Analysis was not reproducible or required consultation with the student to reproduce it. The document is not easy to follow and is not visually attractive.</li>
</ul>
</section>
</section>
<section id="scraping-data" class="level1">
<h1>Scraping Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xml2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geodata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: terra</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.7.78</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::extract()        masks terra::extract()
✖ dplyr::filter()         masks stats::filter()
✖ readr::guess_encoding() masks rvest::guess_encoding()
✖ dplyr::lag()            masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osmdata) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spData)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tmap'

The following object is masked from 'package:datasets':

    rivers</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>wildfire_html <span class="ot">=</span> <span class="fu">read_html</span>(<span class="st">'https://www2.gov.bc.ca/gov/content/safety/wildfire-status/about-bcws/wildfire-statistics'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>wildfire_html</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{html_document}
&lt;html lang="en"&gt;
[1] &lt;head&gt;\n&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8 ...
[2] &lt;body&gt;\n&lt;div id="__next" data-reactroot=""&gt;\n&lt;script src="/env-config.js" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>wildfire <span class="ot">=</span> wildfire_html <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">"table"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>wildfire</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,108 × 8
    Year `Fire Number` `Fire Centre` Latitude  Longitude  Geographic            
   &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;                 
 1  2017 C50011 (2017) Cariboo       51 56.952 123 08.113 Lee's Corner          
 2  2017 C50043 (2017) Cariboo       51 59.384 123 09.690 3 Km East Anaham Rese…
 3  2017 C10248 (2017) Cariboo       53 10.077 123 02.022 Pantage Lake          
 4  2017 C40329 (2017) Cariboo       51 45.338 121 50.060 6km SE of Place Lake  
 5  2017 C20352 (2017) Cariboo       51 44.568 121 59.996 4 km W of Emerald Lake
 6  2017 C20414 (2017) Cariboo       52 00.900 122 54.032 Raven Lake            
 7  2017 C31005 (2017) Cariboo       52 24.298 121 32.763 SW End of Antoine Lake
 8  2017 C40621 (2017) Cariboo       51 39.247 121 23.922 Gustafsen Road        
 9  2017 C10683 (2017) Cariboo       52 48.617 122 18.217 Green Mountain        
10  2017 C10701 (2017) Cariboo       52 39.916 122 29.296 Fraser River Narcosli…
# ℹ 1,098 more rows
# ℹ 2 more variables: `Discovery Date` &lt;chr&gt;, `Size (ha)` &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(wildfire<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2017 2016 2015 2014 2013 2012</code></pre>
</div>
</div>
</section>
<section id="fix-the-wildfire-data" class="level1">
<h1>fix the wildfire data</h1>
<p>I will first seperate the data into monthly distributed from january to december</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>wildfire_time <span class="ot">=</span> wildfire <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'january'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'february'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'march'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'april'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'may'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'june'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'july'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'august'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">8</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'september'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">9</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'october'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">10</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'november'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">11</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">'december'</span>, <span class="st">`</span><span class="at">Discovery Date</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">12</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>wildfire_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,108 × 9
    Year `Fire Number` `Fire Centre` Latitude  Longitude  Geographic            
   &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;                 
 1  2017 C50011 (2017) Cariboo       51 56.952 123 08.113 Lee's Corner          
 2  2017 C50043 (2017) Cariboo       51 59.384 123 09.690 3 Km East Anaham Rese…
 3  2017 C10248 (2017) Cariboo       53 10.077 123 02.022 Pantage Lake          
 4  2017 C40329 (2017) Cariboo       51 45.338 121 50.060 6km SE of Place Lake  
 5  2017 C20352 (2017) Cariboo       51 44.568 121 59.996 4 km W of Emerald Lake
 6  2017 C20414 (2017) Cariboo       52 00.900 122 54.032 Raven Lake            
 7  2017 C31005 (2017) Cariboo       52 24.298 121 32.763 SW End of Antoine Lake
 8  2017 C40621 (2017) Cariboo       51 39.247 121 23.922 Gustafsen Road        
 9  2017 C10683 (2017) Cariboo       52 48.617 122 18.217 Green Mountain        
10  2017 C10701 (2017) Cariboo       52 39.916 122 29.296 Fraser River Narcosli…
# ℹ 1,098 more rows
# ℹ 3 more variables: `Discovery Date` &lt;chr&gt;, `Size (ha)` &lt;dbl&gt;, month &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now, deal with longitude and latitude, as this type of coordinates is not what i want, i have to do the transformation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>convert_latitude <span class="ot">=</span> <span class="cf">function</span>(coord) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  matches <span class="ot">=</span> <span class="fu">regexec</span>(<span class="st">"([0-9]+) ([0-9]+</span><span class="sc">\\</span><span class="st">.?[0-9]*)"</span>, coord)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  matched_strings <span class="ot">=</span> <span class="fu">regmatches</span>(coord, matches)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  degrees <span class="ot">=</span> <span class="fu">as.numeric</span>(matched_strings[[<span class="dv">1</span>]][<span class="dv">2</span>])</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  minutes <span class="ot">=</span> <span class="fu">as.numeric</span>(matched_strings[[<span class="dv">1</span>]][<span class="dv">3</span>])</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  decimal <span class="ot">=</span> degrees <span class="sc">+</span> minutes <span class="sc">/</span> <span class="dv">60</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(decimal)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>convert_longitude <span class="ot">=</span> <span class="cf">function</span>(coord) {</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  matches <span class="ot">=</span> <span class="fu">regexec</span>(<span class="st">"([0-9]+) ([0-9]+</span><span class="sc">\\</span><span class="st">.?[0-9]*)"</span>, coord)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  matched_strings <span class="ot">=</span> <span class="fu">regmatches</span>(coord, matches)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  degrees <span class="ot">=</span> <span class="fu">as.numeric</span>(matched_strings[[<span class="dv">1</span>]][<span class="dv">2</span>])</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  minutes <span class="ot">=</span> <span class="fu">as.numeric</span>(matched_strings[[<span class="dv">1</span>]][<span class="dv">3</span>])</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  decimal <span class="ot">=</span> degrees <span class="sc">+</span> minutes <span class="sc">/</span> <span class="dv">60</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>decimal)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Apply the function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wildfire_coord <span class="ot">=</span> wildfire_time</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>wildfire_coord<span class="sc">$</span>longitude <span class="ot">=</span> <span class="fu">sapply</span>(wildfire_time<span class="sc">$</span>Longitude, convert_longitude)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>wildfire_coord<span class="sc">$</span>latitude <span class="ot">=</span> <span class="fu">sapply</span>(wildfire_time<span class="sc">$</span>Latitude, convert_latitude)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>wildfire_coord</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,108 × 11
    Year `Fire Number` `Fire Centre` Latitude  Longitude  Geographic            
   &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;                 
 1  2017 C50011 (2017) Cariboo       51 56.952 123 08.113 Lee's Corner          
 2  2017 C50043 (2017) Cariboo       51 59.384 123 09.690 3 Km East Anaham Rese…
 3  2017 C10248 (2017) Cariboo       53 10.077 123 02.022 Pantage Lake          
 4  2017 C40329 (2017) Cariboo       51 45.338 121 50.060 6km SE of Place Lake  
 5  2017 C20352 (2017) Cariboo       51 44.568 121 59.996 4 km W of Emerald Lake
 6  2017 C20414 (2017) Cariboo       52 00.900 122 54.032 Raven Lake            
 7  2017 C31005 (2017) Cariboo       52 24.298 121 32.763 SW End of Antoine Lake
 8  2017 C40621 (2017) Cariboo       51 39.247 121 23.922 Gustafsen Road        
 9  2017 C10683 (2017) Cariboo       52 48.617 122 18.217 Green Mountain        
10  2017 C10701 (2017) Cariboo       52 39.916 122 29.296 Fraser River Narcosli…
# ℹ 1,098 more rows
# ℹ 5 more variables: `Discovery Date` &lt;chr&gt;, `Size (ha)` &lt;dbl&gt;, month &lt;dbl&gt;,
#   longitude &lt;dbl&gt;, latitude &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now the coordinate and the time are transformed.</p>
</section>
<section id="pull-elevation-data" class="level1">
<h1>Pull elevation data</h1>
<p>This is how BC looks like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>can <span class="ot">=</span> <span class="fu">gadm</span>(<span class="st">'CAN'</span>,<span class="at">level =</span> <span class="dv">1</span>,<span class="at">path =</span> <span class="fu">tempdir</span>())</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>bc <span class="ot">=</span> can[can<span class="sc">$</span>NAME_1 <span class="sc">==</span> <span class="st">'British Columbia'</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>bc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> class       : SpatVector 
 geometry    : polygons 
 dimensions  : 1, 11  (geometries, attributes)
 extent      : -139.0522, -114.0542, 48.30861, 60.00007  (xmin, xmax, ymin, ymax)
 coord. ref. : lon/lat WGS 84 (EPSG:4326) 
 names       :   GID_1 GID_0 COUNTRY           NAME_1       VARNAME_1 NL_NAME_1
 type        :   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;
 values      : CAN.2_1   CAN  Canada British Columbia Colombie brita~        NA
   TYPE_1 ENGTYPE_1  CC_1 HASC_1 ISO_1
    &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;
 Province  Province    59  CA.BC CA-BC</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bc, <span class="at">lwd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Elevation data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>can_ele <span class="ot">=</span> <span class="fu">elevation_30s</span>(<span class="at">country =</span> <span class="st">'CAN'</span>,<span class="at">path =</span> <span class="fu">tempdir</span>())</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>can_ele</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 5016, 10644, 1  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : -141.2, -52.5, 41.5, 83.3  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source      : CAN_elv_msk.tif 
name        : CAN_elv_msk 
min value   :        -136 
max value   :        5800 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(can_ele)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="crop-and-mask-elevation-data" class="level1">
<h1>crop and mask elevation data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bc_ele <span class="ot">=</span> <span class="fu">crop</span>(can_ele, bc)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>bc_ele <span class="ot">=</span> <span class="fu">mask</span>(bc_ele, bc)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>bc_ele</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 1403, 2999, 1  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : -139.05, -114.0583, 48.30833, 60  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
varname     : CAN_elv_msk 
name        : CAN_elv_msk 
min value   :        -136 
max value   :        3579 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bc_ele)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>now plot the dots on the plot,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wildfire_sf <span class="ot">=</span> <span class="fu">st_as_sf</span>(wildfire_coord, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>wildfire_sf <span class="ot">=</span> <span class="fu">st_transform</span>(wildfire_sf, <span class="fu">st_crs</span>(bc_ele))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>tm_bc_ele <span class="ot">=</span> <span class="fu">tm_shape</span>(bc_ele) <span class="sc">+</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">terrain.colors</span>(<span class="dv">1000</span>), <span class="at">title =</span> <span class="st">"Elevation (m)"</span>, <span class="at">style =</span> <span class="st">"cont"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[v3-&gt;v4] `tm_raster()`: instead of `style = "cont"`, use col.scale =
`tm_scale_continuous()`.
ℹ Migrate the argument(s) 'palette' (rename to 'values') to
  'tm_scale_continuous(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tm_bc_ele</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tm_bc_ele_sf <span class="ot">=</span> tm_bc_ele <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(wildfire_sf) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">fill_alpha =</span> <span class="fl">0.3</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>tm_bc_ele_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From this graph, we can tell that the wildfire gathers at the low elevation area, as high elevation area contains less oxygen than those low elevation area. Most fires appears lower than 1000m.</p>
<p>#Pull temperature data Now coming to weather,pulling data first</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>can_temp <span class="ot">=</span> <span class="fu">worldclim_country</span>(<span class="st">'CAN'</span>,<span class="at">var =</span> <span class="st">"tavg"</span>, <span class="at">path =</span> <span class="fu">tempdir</span>())</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>can_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 5040, 10680, 12  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : -141.5, -52.5, 41.5, 83.5  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source      : CAN_wc2.1_30s_tavg.tif 
names       : CAN_w~avg_1, CAN_w~avg_2, CAN_w~avg_3, CAN_w~avg_4, CAN_w~avg_5, CAN_w~avg_6, ... 
min values  :       -42.4,       -44.1,       -43.3,       -34.7,       -21.6,       -16.1, ... 
max values  :         9.5,         9.7,        10.0,        12.4,        17.2,        22.5, ... </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(can_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>#crop and mask temperature data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>bc_temp <span class="ot">=</span> <span class="fu">crop</span>(can_temp, bc)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>bc_temp <span class="ot">=</span> <span class="fu">mask</span>(bc_temp, bc)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>bc_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 1403, 2999, 12  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : -139.05, -114.0583, 48.30833, 60  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
varname     : CAN_wc2.1_30s_tavg 
names       : CAN_w~avg_1, CAN_w~avg_2, CAN_w~avg_3, CAN_w~avg_4, CAN_w~avg_5, CAN_w~avg_6, ... 
min values  :       -24.5,       -18.2,       -18.4,       -16.9,       -11.9,        -7.4, ... 
max values  :         7.1,         7.4,         7.5,        10.3,        14.8,        18.9, ... </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bc_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualize-the-temperature-data" class="level1">
<h1>visualize the temperature data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>month <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">'list'</span>,<span class="at">length =</span> <span class="dv">12</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>months <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'January'</span>,<span class="st">'Febuary'</span>,<span class="st">'March'</span>,<span class="st">'April'</span>,<span class="st">'May'</span>,<span class="st">'June'</span>,<span class="st">'July'</span>,<span class="st">'August'</span>,<span class="st">'September'</span>,<span class="st">'October'</span>,<span class="st">'November'</span>,<span class="st">'December'</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  month[[i]] <span class="ot">=</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(bc_temp[[i]]) <span class="sc">+</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">terrain.colors</span>(<span class="dv">100</span>), <span class="at">title=</span> months[i], <span class="at">style =</span> <span class="st">"cont"</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[v3-&gt;v4] `tm_raster()`: instead of `style = "cont"`, use col.scale =
`tm_scale_continuous()`.
ℹ Migrate the argument(s) 'palette' (rename to 'values') to
  'tm_scale_continuous(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'
[v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'title' to 'col.legend = tm_legend(&lt;HERE&gt;)'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>month</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[9]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[10]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[11]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[12]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-14-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>plot dots on the graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>wf_temp <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">'list'</span>,<span class="at">length =</span>  <span class="dv">12</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>){</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  wildfire_month <span class="ot">=</span> wildfire_coord <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(month <span class="sc">==</span> i)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(wildfire_month) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  wildfire_month <span class="ot">=</span> <span class="fu">st_as_sf</span>(wildfire_month, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  wildfire_month <span class="ot">=</span> <span class="fu">st_transform</span>(wildfire_month, <span class="fu">st_crs</span>(bc_temp))</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  wf_temp[[i]] <span class="ot">=</span> month[[i]] <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_shape</span>(wildfire_month) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">fill_alpha =</span> <span class="fl">0.3</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    wf_temp[[i]] <span class="ot">=</span>  month[[i]]</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>wf_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[9]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[10]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[11]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[12]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-15-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now , from the graphs , we can easily tell that those wildfire only happen at the area with temperature greater than 0。</p>
<p>#How does elevation and temperature correlated with wildfire</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>wildfire_vect <span class="ot">=</span> <span class="fu">vect</span>(wildfire_sf)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>elevation_value <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_ele, wildfire_vect)[,<span class="dv">2</span>]</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>wildfire_elevation <span class="ot">=</span> wildfire_sf <span class="sc">%&gt;%</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">elevation =</span> elevation_value) </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>wildfire_elevation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1108 features and 10 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -134.021 ymin: 48.38862 xmax: -114.3025 ymax: 59.98007
Geodetic CRS:  WGS 84
# A tibble: 1,108 × 11
    Year `Fire Number` `Fire Centre` Latitude  Longitude  Geographic            
 * &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;                 
 1  2017 C50011 (2017) Cariboo       51 56.952 123 08.113 Lee's Corner          
 2  2017 C50043 (2017) Cariboo       51 59.384 123 09.690 3 Km East Anaham Rese…
 3  2017 C10248 (2017) Cariboo       53 10.077 123 02.022 Pantage Lake          
 4  2017 C40329 (2017) Cariboo       51 45.338 121 50.060 6km SE of Place Lake  
 5  2017 C20352 (2017) Cariboo       51 44.568 121 59.996 4 km W of Emerald Lake
 6  2017 C20414 (2017) Cariboo       52 00.900 122 54.032 Raven Lake            
 7  2017 C31005 (2017) Cariboo       52 24.298 121 32.763 SW End of Antoine Lake
 8  2017 C40621 (2017) Cariboo       51 39.247 121 23.922 Gustafsen Road        
 9  2017 C10683 (2017) Cariboo       52 48.617 122 18.217 Green Mountain        
10  2017 C10701 (2017) Cariboo       52 39.916 122 29.296 Fraser River Narcosli…
# ℹ 1,098 more rows
# ℹ 5 more variables: `Discovery Date` &lt;chr&gt;, `Size (ha)` &lt;dbl&gt;, month &lt;dbl&gt;,
#   geometry &lt;POINT [°]&gt;, elevation &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wildfire_elevation, <span class="fu">aes</span>(<span class="at">x =</span> elevation)) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">100</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Elevation (m)"</span>, <span class="at">y =</span> <span class="st">"Number of Wildfires"</span>, <span class="at">title =</span> <span class="st">"Number of fires decrease after 700 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the histogram, we can see that most fire happens at elevation from 500m - 1100m, and decrease as the elevation gets higher. Thus, there’s a possibly negative correlation between wildfire and elevation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wildfire_coord, <span class="fu">aes</span>(<span class="at">x =</span> month)) <span class="sc">+</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Number of Wildfires"</span>, <span class="at">title =</span> <span class="st">"Wildfire most appears summer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the graph we can tell that most fire happens during month7 and month8 and fire barely happens on month 11 - month2. So look further on the temperature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>wildfire_degree <span class="ot">=</span> wildfire_sf <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">case_when</span>(</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">1</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">2</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">3</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">4</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">5</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">6</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">7</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">8</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">9</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">10</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">11</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">12</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">100</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>wildfire_degree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1108 features and 10 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -134.021 ymin: 48.38862 xmax: -114.3025 ymax: 59.98007
Geodetic CRS:  WGS 84
# A tibble: 1,108 × 11
    Year `Fire Number` `Fire Centre` Latitude  Longitude  Geographic            
 * &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;                 
 1  2017 C50011 (2017) Cariboo       51 56.952 123 08.113 Lee's Corner          
 2  2017 C50043 (2017) Cariboo       51 59.384 123 09.690 3 Km East Anaham Rese…
 3  2017 C10248 (2017) Cariboo       53 10.077 123 02.022 Pantage Lake          
 4  2017 C40329 (2017) Cariboo       51 45.338 121 50.060 6km SE of Place Lake  
 5  2017 C20352 (2017) Cariboo       51 44.568 121 59.996 4 km W of Emerald Lake
 6  2017 C20414 (2017) Cariboo       52 00.900 122 54.032 Raven Lake            
 7  2017 C31005 (2017) Cariboo       52 24.298 121 32.763 SW End of Antoine Lake
 8  2017 C40621 (2017) Cariboo       51 39.247 121 23.922 Gustafsen Road        
 9  2017 C10683 (2017) Cariboo       52 48.617 122 18.217 Green Mountain        
10  2017 C10701 (2017) Cariboo       52 39.916 122 29.296 Fraser River Narcosli…
# ℹ 1,098 more rows
# ℹ 5 more variables: `Discovery Date` &lt;chr&gt;, `Size (ha)` &lt;dbl&gt;, month &lt;dbl&gt;,
#   geometry &lt;POINT [°]&gt;, degree &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wildfire_degree, <span class="fu">aes</span>(<span class="at">x =</span> degree)) <span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Degree"</span>, <span class="at">y =</span> <span class="st">"Number of Wildfires"</span>, <span class="at">title =</span> <span class="st">"Relation between Wildfire and Temperature"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the histogram, we can easily tell that the number of wildfire increase as the temperature increase till about 12.5 but then decrease as the temperature get higher.</p>
</section>
<section id="this-years-wildfire" class="level1">
<h1>This year’s wildfire</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>wildfire_2024 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'/Users/vanris/Documents/UG -DATA6200/ASS2/C_FIRE_PNT.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1685 Columns: 24
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (11): FIRE_NO, RSPNS_TYPC, FIRESTATUS, FIRE_CAUSE, FIRE_TYPE, INCDNT_NM,...
dbl (12): FIRE_YEAR, IGN_DATE, FR_T_DTE, FIRE_CENTR, ZONE, FIRE_ID, LATITUDE...
lgl  (1): SHAPE

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wildfire_2024)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 24
  FIRE_NO FIRE_YEAR RSPNS_TYPC IGN_DATE FR_T_DTE FIRESTATUS FIRE_CAUSE
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
1 G70183       2024 Full        2.02e13  2.02e13 Out        Person    
2 K70416       2024 Full        2.02e13  2.02e13 Out        Person    
3 G70167       2024 Full        2.02e13  2.02e13 Out        Person    
4 K40213       2024 Full        2.02e13  2.02e13 Out        Person    
5 VA0145       2024 Full        2.02e13  2.02e13 Out        Person    
6 K70783       2024 Full        2.02e13  2.02e13 Out        Person    
# ℹ 17 more variables: FIRE_CENTR &lt;dbl&gt;, ZONE &lt;dbl&gt;, FIRE_ID &lt;dbl&gt;,
#   FIRE_TYPE &lt;chr&gt;, INCDNT_NM &lt;chr&gt;, GEO_DESC &lt;chr&gt;, LATITUDE &lt;dbl&gt;,
#   LONGITUDE &lt;dbl&gt;, SIZE_HA &lt;dbl&gt;, FIRE_URL &lt;chr&gt;, FR_F_NT_ND &lt;chr&gt;,
#   WS_FR_F_ND &lt;chr&gt;, FCODE &lt;chr&gt;, SHAPE &lt;lgl&gt;, OBJECTID &lt;dbl&gt;,
#   X_COORDINATE &lt;dbl&gt;, Y_COORDINATE &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Check the elevation first</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>wildfire_2024_month <span class="ot">=</span> wildfire_2024 <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(<span class="fu">as.character</span>(IGN_DATE),<span class="dv">5</span>,<span class="dv">6</span>)))</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>wildfire_2024_month</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,685 × 25
   FIRE_NO FIRE_YEAR RSPNS_TYPC IGN_DATE FR_T_DTE FIRESTATUS FIRE_CAUSE
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
 1 G70183       2024 Full        2.02e13  2.02e13 Out        Person    
 2 K70416       2024 Full        2.02e13  2.02e13 Out        Person    
 3 G70167       2024 Full        2.02e13  2.02e13 Out        Person    
 4 K40213       2024 Full        2.02e13  2.02e13 Out        Person    
 5 VA0145       2024 Full        2.02e13  2.02e13 Out        Person    
 6 K70783       2024 Full        2.02e13  2.02e13 Out        Person    
 7 V70988       2024 Full        2.02e13  2.02e13 Out        Person    
 8 C10787       2024 Full        2.02e 7  2.02e13 Out        Lightning 
 9 G91053       2024 Full        2.02e13  2.02e13 Out        Lightning 
10 G71689       2024 Monitor     2.02e13  2.02e13 Out        Person    
# ℹ 1,675 more rows
# ℹ 18 more variables: FIRE_CENTR &lt;dbl&gt;, ZONE &lt;dbl&gt;, FIRE_ID &lt;dbl&gt;,
#   FIRE_TYPE &lt;chr&gt;, INCDNT_NM &lt;chr&gt;, GEO_DESC &lt;chr&gt;, LATITUDE &lt;dbl&gt;,
#   LONGITUDE &lt;dbl&gt;, SIZE_HA &lt;dbl&gt;, FIRE_URL &lt;chr&gt;, FR_F_NT_ND &lt;chr&gt;,
#   WS_FR_F_ND &lt;chr&gt;, FCODE &lt;chr&gt;, SHAPE &lt;lgl&gt;, OBJECTID &lt;dbl&gt;,
#   X_COORDINATE &lt;dbl&gt;, Y_COORDINATE &lt;dbl&gt;, month &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>wildfire_2024_sf <span class="ot">=</span> <span class="fu">st_as_sf</span>(wildfire_2024_month, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">'LONGITUDE'</span>,<span class="st">'LATITUDE'</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>wildfire_2024_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1685 features and 23 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -133.4124 ymin: 48.4668 xmax: -114.5043 ymax: 59.9461
Geodetic CRS:  WGS 84
# A tibble: 1,685 × 24
   FIRE_NO FIRE_YEAR RSPNS_TYPC IGN_DATE FR_T_DTE FIRESTATUS FIRE_CAUSE
 * &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
 1 G70183       2024 Full        2.02e13  2.02e13 Out        Person    
 2 K70416       2024 Full        2.02e13  2.02e13 Out        Person    
 3 G70167       2024 Full        2.02e13  2.02e13 Out        Person    
 4 K40213       2024 Full        2.02e13  2.02e13 Out        Person    
 5 VA0145       2024 Full        2.02e13  2.02e13 Out        Person    
 6 K70783       2024 Full        2.02e13  2.02e13 Out        Person    
 7 V70988       2024 Full        2.02e13  2.02e13 Out        Person    
 8 C10787       2024 Full        2.02e 7  2.02e13 Out        Lightning 
 9 G91053       2024 Full        2.02e13  2.02e13 Out        Lightning 
10 G71689       2024 Monitor     2.02e13  2.02e13 Out        Person    
# ℹ 1,675 more rows
# ℹ 17 more variables: FIRE_CENTR &lt;dbl&gt;, ZONE &lt;dbl&gt;, FIRE_ID &lt;dbl&gt;,
#   FIRE_TYPE &lt;chr&gt;, INCDNT_NM &lt;chr&gt;, GEO_DESC &lt;chr&gt;, SIZE_HA &lt;dbl&gt;,
#   FIRE_URL &lt;chr&gt;, FR_F_NT_ND &lt;chr&gt;, WS_FR_F_ND &lt;chr&gt;, FCODE &lt;chr&gt;,
#   SHAPE &lt;lgl&gt;, OBJECTID &lt;dbl&gt;, X_COORDINATE &lt;dbl&gt;, Y_COORDINATE &lt;dbl&gt;,
#   month &lt;dbl&gt;, geometry &lt;POINT [°]&gt;</code></pre>
</div>
</div>
<p>Now attach the corresponding elevation and temperature data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>wildfire_2024_vect <span class="ot">=</span> <span class="fu">vect</span>(wildfire_2024_sf)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>elevation_value <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_ele, wildfire_2024_vect)[,<span class="dv">2</span>]</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>wildfire_2024_elevation <span class="ot">=</span> wildfire_2024_sf <span class="sc">%&gt;%</span> </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">elevation =</span> elevation_value) </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>wildfire_2024_elevation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1685 features and 24 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -133.4124 ymin: 48.4668 xmax: -114.5043 ymax: 59.9461
Geodetic CRS:  WGS 84
# A tibble: 1,685 × 25
   FIRE_NO FIRE_YEAR RSPNS_TYPC IGN_DATE FR_T_DTE FIRESTATUS FIRE_CAUSE
 * &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
 1 G70183       2024 Full        2.02e13  2.02e13 Out        Person    
 2 K70416       2024 Full        2.02e13  2.02e13 Out        Person    
 3 G70167       2024 Full        2.02e13  2.02e13 Out        Person    
 4 K40213       2024 Full        2.02e13  2.02e13 Out        Person    
 5 VA0145       2024 Full        2.02e13  2.02e13 Out        Person    
 6 K70783       2024 Full        2.02e13  2.02e13 Out        Person    
 7 V70988       2024 Full        2.02e13  2.02e13 Out        Person    
 8 C10787       2024 Full        2.02e 7  2.02e13 Out        Lightning 
 9 G91053       2024 Full        2.02e13  2.02e13 Out        Lightning 
10 G71689       2024 Monitor     2.02e13  2.02e13 Out        Person    
# ℹ 1,675 more rows
# ℹ 18 more variables: FIRE_CENTR &lt;dbl&gt;, ZONE &lt;dbl&gt;, FIRE_ID &lt;dbl&gt;,
#   FIRE_TYPE &lt;chr&gt;, INCDNT_NM &lt;chr&gt;, GEO_DESC &lt;chr&gt;, SIZE_HA &lt;dbl&gt;,
#   FIRE_URL &lt;chr&gt;, FR_F_NT_ND &lt;chr&gt;, WS_FR_F_ND &lt;chr&gt;, FCODE &lt;chr&gt;,
#   SHAPE &lt;lgl&gt;, OBJECTID &lt;dbl&gt;, X_COORDINATE &lt;dbl&gt;, Y_COORDINATE &lt;dbl&gt;,
#   month &lt;dbl&gt;, geometry &lt;POINT [°]&gt;, elevation &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wildfire_2024_elevation, <span class="fu">aes</span>(<span class="at">x =</span> elevation)) <span class="sc">+</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">100</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Elevation (m)"</span>, <span class="at">y =</span> <span class="st">"Number of Wildfires"</span>, <span class="at">title =</span> <span class="st">"Number of fires decrease after 1000 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The output looks mostly the same, but theres still differences exists.For 2024, fire happens around height 700m to 1500m,and peaks at 1000m while the history data centers 700m and have lower cases after 1100m.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wildfire_2024_sf, <span class="fu">aes</span>(<span class="at">x =</span> month)) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Number of Wildfires"</span>, <span class="at">title =</span> <span class="st">"Wildfire most appears summer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When looking at the month, it’s not hard to tell that most wildfire appears in july and august, which is the hottest time in BC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>wildfire_2024_degree <span class="ot">=</span> wildfire_2024_sf <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">case_when</span>(</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">1</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">2</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">3</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">4</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">5</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">6</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">7</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">8</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">9</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">10</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">11</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> terra<span class="sc">::</span><span class="fu">extract</span>(bc_temp[[<span class="dv">12</span>]], <span class="fu">vect</span>(geometry))[, <span class="dv">2</span>],  </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">100</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>wildfire_2024_degree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1685 features and 24 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -133.4124 ymin: 48.4668 xmax: -114.5043 ymax: 59.9461
Geodetic CRS:  WGS 84
# A tibble: 1,685 × 25
   FIRE_NO FIRE_YEAR RSPNS_TYPC IGN_DATE FR_T_DTE FIRESTATUS FIRE_CAUSE
 * &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
 1 G70183       2024 Full        2.02e13  2.02e13 Out        Person    
 2 K70416       2024 Full        2.02e13  2.02e13 Out        Person    
 3 G70167       2024 Full        2.02e13  2.02e13 Out        Person    
 4 K40213       2024 Full        2.02e13  2.02e13 Out        Person    
 5 VA0145       2024 Full        2.02e13  2.02e13 Out        Person    
 6 K70783       2024 Full        2.02e13  2.02e13 Out        Person    
 7 V70988       2024 Full        2.02e13  2.02e13 Out        Person    
 8 C10787       2024 Full        2.02e 7  2.02e13 Out        Lightning 
 9 G91053       2024 Full        2.02e13  2.02e13 Out        Lightning 
10 G71689       2024 Monitor     2.02e13  2.02e13 Out        Person    
# ℹ 1,675 more rows
# ℹ 18 more variables: FIRE_CENTR &lt;dbl&gt;, ZONE &lt;dbl&gt;, FIRE_ID &lt;dbl&gt;,
#   FIRE_TYPE &lt;chr&gt;, INCDNT_NM &lt;chr&gt;, GEO_DESC &lt;chr&gt;, SIZE_HA &lt;dbl&gt;,
#   FIRE_URL &lt;chr&gt;, FR_F_NT_ND &lt;chr&gt;, WS_FR_F_ND &lt;chr&gt;, FCODE &lt;chr&gt;,
#   SHAPE &lt;lgl&gt;, OBJECTID &lt;dbl&gt;, X_COORDINATE &lt;dbl&gt;, Y_COORDINATE &lt;dbl&gt;,
#   month &lt;dbl&gt;, geometry &lt;POINT [°]&gt;, degree &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wildfire_2024_degree, <span class="fu">aes</span>(<span class="at">x =</span> degree)) <span class="sc">+</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Degree"</span>, <span class="at">y =</span> <span class="st">"Number of Wildfires"</span>, <span class="at">title =</span> <span class="st">"Relation between Wildfire and Temperature"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the graph, most fire are caused above 10 degrees, which is mostly the same pattern as the history data and also the peaks are 15 degree. And the numebr of wildfire decrease after 15.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>